/*!
 * Copyright 2006 - 2015 TubePress LLC (http://tubepress.com/).
 * This file is part of TubePress Pro.
 * REDISTRIBUTION PROHIBITED. Please see http://tubepress.com/license for details.
 */
(function(D,J){var N=J.Lang.Utils,U=J.Beacon,y=J.Logger,l=U.subscribe,r=U.publish,a=y.on(),i=y.log,A=N.isDefined,Q=false,c=!Q,k="Gallery",x=".",O="_",L="-",e="item",B="page",M=" ",p="Id",T="id",P="",w=e+p,f="tubepress",n="gallery",H="PlayerApi",C="sequence",j=n+p,z=f+x+n+x,u=z+e+x,m=u+"change",K=u+"next",g=u+"previous",o=u+"start",b=u+"stop",G=z+B+"change",h=z+"load",F=z+"newthumbs",R=(function(){var V=function(){return J[k]},W=function(){return J[H]};return{getPlayerApiJs:W,getGalleryJs:V}}()),t=function(X,W,V){return R.getGalleryJs().Options.getOption(X,W,V)},S=(function(){var X=Q,ab=[],W=function(){return X||A(J[k])},V=function(af){var ae=0,ac=R.getGalleryJs().Registry,ad=ac.getAll(),ag;for(ae;ae<af.length;ae+=1){ag=af[ae];ag(ad)}},aa=function(ac){if(W()){V([ac])}else{ab.push(ac)}},Z=function(){if(X){return}if(a){i(n+".js is available for Pro")}X=c;V(ab)},Y=function(ac,af){var ad,ae;for(ad in ac){if(ac.hasOwnProperty(ad)){ae={};ae[j]=ad;ae.params=ac[ad];af({},ae)}}};l(f+x+"js.sys."+n,Z);return{addGalleryJsReadyHandler:aa,runForAllExistingGalleries:Y}}()),q=(function(){var V=function(X,W){i(n+M+X+M+W)};return{log:V}}()),d=(function(){var V={},ab={},Z={},aa=function(){return R.getGalleryJs().Selectors},Y=function(ae){if(!V.hasOwnProperty(ae)){var ad=aa(),ac=ad.getOutermostSelectorLegacy(ae);V[ae]=D(ac).length>0}return V[ae]},W=function(ad){if(!ab.hasOwnProperty(ad)){var ac=aa();if(Y(ad)){ab[ad]=ac.getOutermostSelectorLegacy(ad)}else{ab[ad]=ac.getOutermostSelectorModern(ad)}}return ab[ad]},X=function(ad){if(!Z.hasOwnProperty(ad)){var ac=aa();if(Y(ad)){Z[ad]=ac.getThumbAreaSelectorLegacy(ad)}else{Z[ad]=ac.getThumbAreaSelectorModern(ad)}}return Z[ad]};return{getOutermostSelector:W,getThumbAreaSelector:X}}()),v=(function(){var W=function(X){return X[j]},V=function(X){return X[w]};return{getGalleryIdFromEventData:W,getItemIdFromEventData:V}}()),I=(function(){var aa={},ad=":first",Y="xyz"+ad,ac="js-"+f+L+n,af=ac+L,X=x+ac+ad,V="something",W,ab,ae=function(ah){var ai=D("#"+ah),ag=ai.parents(X);if(ag.length!==0){W=ag.attr("class").split(/\s+/);ab=0;for(ab;ab<W.length;ab+=1){if(W[ab].indexOf(af)===0){return W[ab].replace(af,P)}}return undefined}ag=ai.parents(Y);if(ag.length===0){return undefined}return ag.attr(T).replace(V,P)},Z=function(ah){var ag=ah.guid;if(!I.hasOwnProperty(ag)){aa[ag]=ae(ag)}return aa[ag]};return{findGalleryId:Z}}()),E=(function(){var ac={},X={},W=q.log,ah=v.getGalleryIdFromEventData,Y=v.getItemIdFromEventData,ae=function(ai){return X[ai]},ab=function(ai){return ac[ai]===c},V=function(ak,aj){var ai=I.findGalleryId(aj);if(a){W(ai,"stopped")}ac[ai]=Q},ag=function(ai,aj){if(a){W(ai,"current item is now "+aj)}X[ai]=aj},af=function(ak,aj){var ai=I.findGalleryId(aj),al=Y(aj);if(a){W(ai,"start item "+al)}ac[ai]=c;ag(ai,al)},ad=function(aj,ai){ag(ah(ai),ai[w])},aa=function(ak,aj){var ai=ah(aj),al=t(ai,"sequence",[]);if(al.length>0){ag(ai,al[0])}ac[ai]=Q},Z=function(ai){S.runForAllExistingGalleries(ai,aa);l(m,ad);l(b,V);l(o,af);l(h,aa)};S.addGalleryJsReadyHandler(Z);return{getCurrentItemId:ae,isCurrentlyPlayingVideo:ab}}()),s=(function(){var V=N.parseIntOrZero,W=N.getParameterByName(f+O+B),ae=V(W),af=v.getGalleryIdFromEventData,X=q.log,Z={},ad=function(ag){var ah=Z[ag];return ah===""?1:ah},ac=function(ah){var ag=V(ah);return ag>0?ag:1},ab=function(aj,ai){var ag=af(ai),ah=ac(ae);if(a){X(ag,"starting on page "+ah)}Z[ag]=ah},Y=function(aj,ai){var ah=af(ai),ag=ac(ai[B]);if(a){X(ah,"change to page "+ag)}Z[ah]=ag},aa=function(ag){S.runForAllExistingGalleries(ag,ab);l(h,ab);l(G,Y)};S.addGalleryJsReadyHandler(aa);return{getCurrentPageNumber:ad}}());(function(){var V=function(aa,Z){var Y=I.findGalleryId(Z),W={},ab,X;if(!Y){return}ab=t(Y,"autoNext",Q)===c;X=t(Y,C,[]).length>0;if(ab&&X){W[j]=Y;r(K,W)}};l(b,V)}());(function(){var X=function(ae,ac){var ad=ae[j],af=t(ad,C,[]),ab=E.getCurrentItemId(ad),Z=D.inArray(ab.toString(),af),Y={},aa=ac?af?af.length-1:Z:0;if(Z===-1||Z===aa){return}Y[j]=ad;Y[w]=af[ac?Z+1:Z-1];r(m,Y)},V=function(Z,Y){X(Y,c)},W=function(Z,Y){X(Y,Q)};l(K,V);l(g,W)}());(function(){var V=function(Y){U.publish(F,{galleryId:Y})},W=function(Z,ac){var ae=R.getGalleryJs().Options.getEphemeralOptions(Z),af=J.Ajax.LoadStyler,ab=d.getThumbAreaSelector(Z),ad=function(){af.removeLoadingStyle(ab);V(Z)},aa={tubepress_action:"shortcode",tubepress_options:ae,tubepress_page:ac},Y=J.Environment.getAjaxEndpointUrl()+M+ab+" > *";if(a){q.log(Z,"load "+Y+" into "+ab)}af.applyLoadingStyle(ab);D(ab).load(Y,aa,ad)},X=function(ac,ab){var Y=v.getGalleryIdFromEventData(ab),aa=ab[B],Z=t(Y,"ajaxPagination",false);if(Z){W(Y,aa)}};U.subscribe(G,X)}());(function(){var W=function(Z){var aa=Z.parents("div.tubepress_container:first"),ab=aa.attr("id");return ab.replace("tubepress_gallery_","")},V=function(ac){var aa=D(ac.target),ad=aa.data(B),Z={},ab=W(aa);ac.preventDefault();Z[j]=ab;Z[B]=ad;r(G,Z);return false},Y=function(af,ae){var ab=v.getGalleryIdFromEventData(ae),ad=t(ab,"ajaxPagination",Q),aa=d.getOutermostSelector(ab),Z=d.getThumbAreaSelector(ab),ac=aa+M+Z+M+"div.pagination a";if(!ad){return}D(ac).click(V)},X=function(Z){S.runForAllExistingGalleries(Z,Y);l(F+M+h,Y)};S.addGalleryJsReadyHandler(X)}());(function(){var X="js-tubepress-page",Z=X+"r",V=X+"-",ad=function(ae){return ae.attr("class").split(/\s+/)},ab=function(ag){var ah=ad(ag),af=0,ae;for(af;af<ah.length;af+=1){ae=ah[af];if(ae.indexOf(V)===0){return ae.replace(V,"")}}return 1},ac=function(ag){var ai=ag.parents("div.js-tubepress-gallery:first"),ah=ad(ai),af=0,ae;for(af;af<ah.length;af+=1){ae=ah[af];if(ae.indexOf("js-tubepress-gallery-")===0){return ae.replace("js-tubepress-gallery-","")}}return undefined},aa=function(ah){var af=D(ah.target),ai=ab(af),ae={},ag=ac(af);ah.preventDefault();ae[j]=ag;ae[B]=ai;r(G,ae);return false},W=function(aj,ai){var af=v.getGalleryIdFromEventData(ai),ah=t(af,"ajaxPagination",Q),ae=d.getThumbAreaSelector(af),ag=ae+" a."+Z;if(!ah){return}D(ag).click(aa)},Y=function(ae){S.runForAllExistingGalleries(ae,W);l(F+M+h,W)};S.addGalleryJsReadyHandler(Y)}());(function(){var V=function(ad,ac){var X="embeddedScroll",Y="target",aa=ac[j],ab=t(aa,X+"On",c),Z=t(aa,X+"Duration",0),W=t(aa,X+"Offset",0);ac.disable=ab!==true;ac[Y]=N.parseIntOrZero(ac[Y])+N.parseIntOrZero(W);ac.duration=N.parseIntOrZero(Z)};U.subscribe(z+".player.scroll",V)}());J.ProGallery={NowShowing:E,PageTracker:s}}(jQuery,TubePress));